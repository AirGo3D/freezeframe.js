var freezeframe=function(e){function t(e){var t;if(this.options={selector:".freezeframe",animation_play_duration:5e3,non_touch_device_trigger_event:"hover"},t="string"==typeof e?{selector:e}:e)for(attribute in t)attribute in this.options?this.options[attribute]=t[attribute]:a(attribute+"not a valid option");this.is_touch_device="ontouchstart"in window||"onmsgesturechange"in window}var a=function(e){console.warn("freezeframe.js : "+e)},s=function(t,s){var i,n=t.images;if(void 0!=s&&n.length>1){if(i=n.filter(e(s)),0==i.length)return a("no images found for selector "+s),!1}else i=n;return i},n=function(e){return 0==e.images.length?!1:!0};return t.prototype.capture=function(t){var s;if(void 0!==t)s=t;else{if(void 0===this.options.selector)return a("no selector passed to capture function or set in options"),!1;s=this.options.selector}for(void 0==this.images&&(this.images=e()),this.images=this.images.add(e("img"+s)),i=0;i<this.images.length;i++)"gif"!==this.images[i].src.split(".").pop().toLowerCase().substring(0,3)&&this.images.splice(i,1);return 0==this.images.length?(console.warn('freezeframe : no gifs found for selector "'+s+'"'),!1):this},t.prototype.setup=function(){var t=this,s=this.images.not(".ff-setup"),i=["ff-container"];return n(t)?0==s.length?(a("unable to run setup(), no images require setup"),!1):(s.each(function(t){var a=e(this);a.addClass("ff-setup ff-image"),a.hasClass("freezeframe-responsive")&&i.push("ff-responsive"),$canvas=e("<canvas />",{"class":"ff-canvas"}).attr({width:0,height:0}).insertBefore(a),a.add($canvas).wrapAll(e("<div />",{"class":i.join(" ")}))}),imagesLoaded(s).on("progress",function(a,s){t.process(e(s.img))}),this):(a("unable to run setup(), no images captured"),!1)},t.prototype.process=function(t){var a=t.siblings("canvas"),s="transitionend webkitTransitionEnd oTransitionEnd otransitionend",i=t[0].clientWidth,n=t[0].clientHeight;return a.attr({width:i,height:n}),context=a[0].getContext("2d"),context.mozImageSmoothingEnabled=!0,context.webkitImageSmoothingEnabled=!0,context.imageSmoothingEnabled=!0,context.drawImage(t[0],0,0,i,n),a.addClass("ff-canvas-ready").on(s,function(){e(this).off(s),t.addClass("ff-image-ready")}),this},t.prototype.attach=function(t){var i=this;return n(i)?(s(i,t).each(function(t){var a=e(this),s=e(this).siblings("canvas");if((!i.is_touch_device&&"hover"==i.options.non_touch_device_trigger_event||i.is_touch_device)&&(a.mouseenter(function(){!function(){a.attr("src",a[0].src),s.removeClass("ff-canvas-ready").addClass("ff-canvas-active")}()}),a.mouseleave(function(){!function(){s.removeClass("ff-canvas-active").addClass("ff-canvas-ready")}()})),!i.is_touch_device&&"click"==i.options.non_touch_device_trigger_event||i.is_touch_device){var n;a.click(function(){!function(){var e=s.hasClass("ff-canvas-active");e?(clearTimeout(n),s.removeClass("ff-canvas-active").addClass("ff-canvas-ready")):(a.attr("src",a[0].src),s.removeClass("ff-canvas-ready").addClass("ff-canvas-active"),n=setTimeout(function(){s.removeClass("ff-canvas-active").addClass("ff-canvas-ready")},i.options.animation_play_duration))}()})}}),this):(a("unable to run attach(), no images captured"),!1)},t.prototype.freeze=function(){return this.capture().setup().attach(),this},t.prototype.trigger=function(t){s(t).each(function(t){e(this).attr("src",e(this)[0].src),e(this).siblings("canvas").removeClass("ff-canvas-ready").addClass("ff-canvas-active")})},t.prototype.release=function(t){s(t).each(function(t){e(this).siblings("canvas").removeClass("ff-canvas-active").addClass("ff-canvas-ready")})},t}(jQuery);