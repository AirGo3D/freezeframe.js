var freezeframe=function(e){function t(e){var t;if(this.options={selector:".freezeframe",animation_play_duration:5e3,non_touch_device_trigger_event:"hover"},t="string"==typeof e?{selector:e}:e)for(attribute in t)attribute in this.options?this.options[attribute]=t[attribute]:console.warn('freezeframe : "'+attribute+'" not a valid option',t);return this.is_touch_device="ontouchstart"in window||"onmsgesturechange"in window,this}return t.prototype.capture=function(t){var a;if(void 0!==t)a=t;else{if(void 0===this.options.selector)return console.warn("freezeframe : no selector passed to capture function or set in freezeframe options"),!1;a=this.options.selector}for(void 0==this.images&&(this.images=e()),this.images=this.images.add(e("img"+a)),i=0;i<this.images.length;i++)"gif"!==this.images[i].src.split(".").pop().toLowerCase().substring(0,3)&&this.images.splice(i,1);return 0==this.images.length?(console.warn('freezeframe : no gifs found for selector "'+a+'"'),!1):this},t.prototype.setup=function(){var t=this,a=this.images.not(".freezeframe-setup"),i=["freezeframe-container"];return a.each(function(t){var a=e(this);a.addClass("freezeframe-setup freezeframe-image"),a.hasClass("freezeframe-responsive")&&i.push("freezeframe-responsive"),$canvas=e("<canvas />",{"class":"freezeframe-canvas"}).attr({width:0,height:0}).insertBefore(a),a.add($canvas).wrapAll(e("<div />",{"class":i.join(" ")}))}),imagesLoaded(a).on("progress",function(a,i){t.process(e(i.img))}),this},t.prototype.process=function(t){var a=t.siblings("canvas"),i="transitionend webkitTransitionEnd oTransitionEnd otransitionend",s=t[0].clientWidth,r=t[0].clientHeight;return a.attr({width:s,height:r}),context=a[0].getContext("2d"),context.mozImageSmoothingEnabled=!0,context.webkitImageSmoothingEnabled=!0,context.imageSmoothingEnabled=!0,context.drawImage(t[0],0,0,s,r),a.addClass("freezeframe-canvas-ready").on(i,function(){e(this).off(i),t.addClass("freezeframe-image-ready")}),this},t.prototype.filter=function(t){var a;if(void 0!=t&&this.images.length>1){if(a=this.images.filter(e(t)),0==a.length)return console.warn('freezeframe : no gifs found for selector "'+t+'"'),!1}else a=this.images;return a},t.prototype.attach=function(t){var a,i;return a=this,this.filter(t).each(function(t){var s=e(this),r=e(this).siblings("canvas");(!a.is_touch_device&&"hover"==a.options.non_touch_device_trigger_event||a.is_touch_device)&&(s.mouseenter(function(){!function(){s.attr("src",s[0].src),r.removeClass("freezeframe-canvas-ready").addClass("freezeframe-canvas-active")}()}),s.mouseleave(function(){!function(){r.removeClass("freezeframe-canvas-active").addClass("freezeframe-canvas-ready")}()})),(!a.is_touch_device&&"click"==a.options.non_touch_device_trigger_event||a.is_touch_device)&&s.click(function(){!function(){var e=r.hasClass("freezeframe-canvas-active");e?(clearTimeout(i),r.removeClass("freezeframe-canvas-active").addClass("freezeframe-canvas-ready")):(s.attr("src",s[0].src),r.removeClass("freezeframe-canvas-ready").addClass("freezeframe-canvas-active"),i=setTimeout(function(){r.removeClass("freezeframe-canvas-active").addClass("freezeframe-canvas-ready")},a.options.animation_play_duration))}()})}),this},t.prototype.freeze=function(){this.capture().setup().attach()},t.prototype.trigger=function(t){this.filter(t).each(function(t){e(this).attr("src",e(this)[0].src),e(this).siblings("canvas").removeClass("freezeframe-canvas-ready").addClass("freezeframe-canvas-active")})},t.prototype.release=function(t){this.filter(t).each(function(t){e(this).siblings("canvas").removeClass("freezeframe-canvas-active").addClass("freezeframe-canvas-ready")})},t}(jQuery);